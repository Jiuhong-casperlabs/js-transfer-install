import { decodeBase16 } from "casper-js-sdk";
import {
  parseSchemasFromBytes,
  parseEventNameAndData,
} from "@make-software/ces-js-parser";

const main = () => {
  const schemaHex =
    "08000000040000004275726e02000000050000006f776e65720b06000000616d6f756e74070e0000004368616e67655365637572697479020000000500000061646d696e0b0e0000007365635f6368616e67655f6d6170110b03110000004465637265617365416c6c6f77616e636504000000050000006f776e65720b070000007370656e6465720b09000000616c6c6f77616e63650707000000646563725f62790711000000496e637265617365416c6c6f77616e636504000000050000006f776e65720b070000007370656e6465720b09000000616c6c6f77616e63650706000000696e635f627907040000004d696e740200000009000000726563697069656e740b06000000616d6f756e74070c000000536574416c6c6f77616e636503000000050000006f776e65720b070000007370656e6465720b09000000616c6c6f77616e636507080000005472616e73666572030000000600000073656e6465720b09000000726563697069656e740b06000000616d6f756e74070c0000005472616e7366657246726f6d04000000070000007370656e6465720b050000006f776e65720b09000000726563697069656e740b06000000616d6f756e7407";
  const schemas = parseSchemasFromBytes(decodeBase16(schemaHex));
  const transformBytes =
    "610000005d0000000e0000006576656e745f5472616e73666572005f8f3905fd2170477888ca61c92501e1e9ae00db0585305ce551ffb26e44f3830098d6b00314f4f7103da45bc0d59b365886eb3c75a76a5f2f1db323d97139956108000064a7b3b6e00d0e03200000007529686c00e225a168b62bf959aeca59d58125ad0e7482fe2d57e0e0a8e1567e0400000036353333";
  const eventNameAndData = parseEventNameAndData(transformBytes, schemas);
  console.log(JSON.stringify(eventNameAndData));
};

// schemaHex is from __events_schema of : https://cspr.live/contract/be20e2dfdecc118e8863854bcd4ba66fd5fa26ccbfc0b81d53dadd81cfddabe7
// transformBytes is from deploy: bad8bbedb8474eb95eb39ba1e31e9b0ce38adfe284c4efa33f0cf46ef870c688 dictionary-d519130a4dcd09e8d4848bab846ffdb096be8803bc792f856ef09828f6dbc368

main();
